<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather Dashboard - FT0371-PIT</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Kanit', sans-serif;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-500 to-purple-600 min-h-screen flex items-center justify-center p-4">
    <div class="bg-white rounded-xl shadow-2xl max-w-2xl w-full overflow-hidden">
        <div class="bg-gradient-to-r from-blue-600 to-blue-800 p-6 text-white">
            <h1 class="text-3xl font-bold mb-2">‡∏™‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</h1>
            <h2 class="text-xl opacity-75">FT0371-PIT - Bangkok (Prawet), TH</h2>
        </div>
        <div class="p-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div id="weather-info" class="space-y-3 text-gray-700"></div>
                <div id="heat-index-display" class="bg-gray-100 rounded-xl p-4 flex flex-col items-center justify-center">
                    <div id="heat-index-flag" class="text-6xl mb-2"></div>
                    <div id="heat-index-value" class="text-4xl font-bold mb-2"></div>
                    <div id="heat-index-level" class="text-2xl font-semibold mb-2"></div>
                    <div id="heat-index-message" class="text-center"></div>
                </div>
            </div>
            <div id="heat-index-details" class="mt-6 p-4 rounded-lg font-bold transition-all duration-300 ease-in-out"></div>
            <div id="error-message" class="bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mt-4 hidden"></div>
            <div id="last-updated" class="text-sm text-gray-500 mt-4 text-center"></div>
        </div>
    </div>

    <script>
        const API_KEY = '9f3db457c1124aa4bdb457c1129aa422';
        const API_ENDPOINT = 'https://api.weather.com/v2/pws/observations/current';
        const STATION_ID = 'IBANGK196';
        const REFRESH_INTERVAL = 300000; // 5 minutes

        const elements = {
            weatherInfo: document.getElementById('weather-info'),
            heatIndexDisplay: document.getElementById('heat-index-display'),
            heatIndexFlag: document.getElementById('heat-index-flag'),
            heatIndexValue: document.getElementById('heat-index-value'),
            heatIndexLevel: document.getElementById('heat-index-level'),
            heatIndexMessage: document.getElementById('heat-index-message'),
            heatIndexDetails: document.getElementById('heat-index-details'),
            errorMessage: document.getElementById('error-message'),
            lastUpdated: document.getElementById('last-updated')
        };

        const heatIndexLevels = [
            { threshold: 27, level: 1, color: 'bg-blue-100 text-blue-800', message: '‡∏õ‡∏Å‡∏ï‡∏¥', flag: 'üè≥Ô∏è', waterIntake: '0.5 ‡∏•‡∏¥‡∏ï‡∏£ / ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á', restTime: '‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á', advice: '‡∏™‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏õ‡∏Å‡∏ï‡∏¥ ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ó‡∏≥‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏õ‡∏Å‡∏ï‡∏¥' },
            { threshold: 32, level: 2, color: 'bg-green-100 text-green-800', message: '‡πÄ‡∏ù‡πâ‡∏≤‡∏£‡∏∞‡∏ß‡∏±‡∏á', flag: 'üü©', waterIntake: '0.5 ‡∏•‡∏¥‡∏ï‡∏£ / ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á', restTime: '50 ‡∏ô‡∏≤‡∏ó‡∏µ / ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á', advice: '‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏£‡∏∞‡∏ß‡∏±‡∏á‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏à‡πâ‡∏á ‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠' },
            { threshold: 41, level: 3, color: 'bg-yellow-100 text-yellow-800', message: '‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢', flag: 'üü®', waterIntake: '1 ‡∏•‡∏¥‡∏ï‡∏£ /‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á', restTime: '45 ‡∏ô‡∏≤‡∏ó‡∏µ / ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á', advice: '‡∏Ñ‡∏ß‡∏£‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏´‡∏ô‡∏±‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏à‡πâ‡∏á ‡∏û‡∏±‡∏Å‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏£‡πà‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏¢‡∏∞ ‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô' },
            { threshold: 54, level: 4, color: 'bg-red-100 text-red-800', message: '‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏¢‡∏¥‡πà‡∏á', flag: 'üü•', waterIntake: '1 ‡∏•‡∏¥‡∏ï‡∏£ /‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á', restTime: '30 ‡∏ô‡∏≤‡∏ó‡∏µ / ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á', advice: '‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏à‡πâ‡∏á ‡∏û‡∏±‡∏Å‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏£‡πà‡∏°‡∏ö‡πà‡∏≠‡∏¢‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥‡∏°‡∏≤‡∏Å‡πÜ' },
            { threshold: Infinity, level: 5, color: 'bg-gray-900 text-white', message: '‡∏ß‡∏¥‡∏Å‡∏§‡∏ï', flag: '‚¨õ', waterIntake: '1 ‡∏•‡∏¥‡∏ï‡∏£ /‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á', restTime: '20 ‡∏ô‡∏≤‡∏ó‡∏µ / ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á', advice: '‡∏´‡∏¢‡∏∏‡∏î‡∏ó‡∏≥‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏à‡πâ‡∏á‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏£‡πà‡∏°‡∏´‡∏£‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏≠‡∏≤‡∏Å‡∏≤‡∏® ‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥‡∏°‡∏≤‡∏Å‡πÜ' }
        ];

        async function fetchWeather() {
            try {
                const url = `${API_ENDPOINT}?stationId=${STATION_ID}&format=json&units=m&apiKey=${API_KEY}`;
                const response = await axios.get(url);
                const data = response.data.observations[0];
                updateWeatherDisplay(data);
                elements.errorMessage.classList.add('hidden');
            } catch (error) {
                console.error('Error fetching weather data:', error);
                elements.errorMessage.textContent = `‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®: ${error.message}`;
                elements.errorMessage.classList.remove('hidden');
            }
        }

        function updateWeatherDisplay(data) {
            const { temp, windSpeed, precipTotal, pressure } = data.metric;
            const { humidity, winddir } = data;
            const heatIndex = calculateHeatIndex(temp, humidity);

            elements.weatherInfo.innerHTML = `
                <div class="flex justify-between items-center">
                    <span class="text-5xl font-bold">${temp.toFixed(1)}¬∞C</span>
                    <span class="text-3xl">${getWeatherEmoji(windSpeed, precipTotal)}</span>
                </div>
                <p class="text-lg"><strong>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô:</strong> ${humidity}%</p>
                <p class="text-lg"><strong>‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏•‡∏°:</strong> ${windSpeed.toFixed(1)} km/h</p>
                <p class="text-lg"><strong>‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡∏•‡∏°:</strong> ${getWindDirection(winddir)}</p>
                <p class="text-lg"><strong>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏î‡∏≠‡∏≤‡∏Å‡∏≤‡∏®:</strong> ${pressure.toFixed(1)} hPa</p>
                <p class="text-lg"><strong>‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ô‡πâ‡∏≥‡∏ù‡∏ô (‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ):</strong> ${precipTotal.toFixed(1)} mm</p>
            `;

            displayHeatIndex(heatIndex);
            updateLastUpdated();
        }

        function calculateHeatIndex(temperature, humidity) {
            return 0.5 * (temperature + 61.0 + ((temperature - 68.0) * 1.2) + (humidity * 0.094));
        }

        function displayHeatIndex(heatIndex) {
            const level = heatIndexLevels.find(level => heatIndex < level.threshold);
            const { color, message, flag, waterIntake, restTime, advice } = level;

            elements.heatIndexDisplay.className = `bg-gray-100 rounded-xl p-4 flex flex-col items-center justify-center ${color}`;
            elements.heatIndexFlag.textContent = flag;
            elements.heatIndexValue.textContent = `${heatIndex.toFixed(1)}¬∞C`;
            elements.heatIndexLevel.textContent = `‡∏£‡∏∞‡∏î‡∏±‡∏ö ${level.level}: ${message}`;
            elements.heatIndexMessage.textContent = advice;

            elements.heatIndexDetails.className = `mt-6 p-4 rounded-lg font-bold ${color} transition-all duration-300 ease-in-out`;
            elements.heatIndexDetails.innerHTML = `
                <p class="mb-1"><strong>‡∏Ñ‡πà‡∏≤‡∏î‡∏±‡∏ä‡∏ô‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô:</strong> ${heatIndex.toFixed(1)}¬∞C</p>
                <p class="mb-1"><strong>‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥:</strong> ${waterIntake}</p>
                <p class="mb-1"><strong>‡∏û‡∏±‡∏Å‡πÑ‡∏î‡πâ:</strong> ${restTime}</p>
            `;
        }

        function updateLastUpdated() {
            const now = new Date();
            elements.lastUpdated.textContent = `‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ${now.toLocaleString('th-TH')}`;
        }

        function getWindDirection(degrees) {
            const directions = ['‡πÄ‡∏´‡∏ô‡∏∑‡∏≠', '‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡πÄ‡∏´‡∏ô‡∏∑‡∏≠', '‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å', '‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡πÉ‡∏ï‡πâ', '‡πÉ‡∏ï‡πâ', '‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏ï‡∏Å‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡πÉ‡∏ï‡πâ', '‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏ï‡∏Å', '‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏ï‡∏Å‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡πÄ‡∏´‡∏ô‡∏∑‡∏≠'];
            return directions[Math.round(degrees / 45) % 8];
        }

        function getWeatherEmoji(windSpeed, precipitation) {
            if (precipitation > 0) return 'üåßÔ∏è';
            if (windSpeed > 20) return 'üí®';
            return '‚òÄÔ∏è';
        }

        fetchWeather();
        setInterval(fetchWeather, REFRESH_INTERVAL);
    </script>
</body>
</html>
